<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Sign up — mmdrza.AI</title>

<!-- Inter font -->
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

<!-- Google Identity (force English) -->
<script src="https://accounts.google.com/gsi/client?hl=en" async defer></script>
<!-- reCAPTCHA v2 -->
<script src="https://www.google.com/recaptcha/api.js" async defer></script>

<style>
  :root{
    --bg:#0b0f14;
    --glass: rgba(255,255,255,0.04);
    --glass-2: rgba(255,255,255,0.02);
    --muted:#9aa4ad;
    --text:#e8eef3;
    --accent:#10a37f;
    --accent-600:#0d8a6a;
    --radius:14px;
    --card-w:420px;
    --glass-border: rgba(255,255,255,0.06);
    --shadow: 0 10px 30px rgba(2,6,23,0.6);
  }

  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0;
    font-family:"Inter",system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial;
    background:
      radial-gradient(900px 600px at 10% 10%, rgba(16,163,127,0.06), transparent 8%),
      linear-gradient(180deg,#061018 0%, #0b0f14 100%);
    color:var(--text);
    -webkit-font-smoothing:antialiased;
    -moz-osx-font-smoothing:grayscale;
    display:flex;
    align-items:center;
    justify-content:center;
    padding:28px;
  }

  /* floating subtle decorative shapes */
  .bg-blob{
    position:fixed;
    pointer-events:none;
    filter: blur(48px) saturate(120%);
    opacity:0.12;
  }
  .blob-a{width:420px;height:420px;background:linear-gradient(135deg,#07b68a,#00c2ff);left:6%;top:8%;border-radius:48%;}
  .blob-b{width:360px;height:360px;background:linear-gradient(90deg,#ff6b7a,#ffb86b);right:6%;bottom:6%;border-radius:48%;opacity:0.08;transform:rotate(10deg)}

  .card {
    width: min(92%, var(--card-w));
    border-radius:18px;
    background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
    backdrop-filter: blur(10px) saturate(120%);
    border:1px solid var(--glass-border);
    box-shadow: var(--shadow);
    padding:28px;
    position:relative;
    overflow:hidden;
    transition:transform .28s cubic-bezier(.2,.9,.2,1), box-shadow .28s;
  }
  .card:focus-within, .card:hover{transform:translateY(-6px); box-shadow: 0 20px 45px rgba(2,6,23,0.7);}

  .brand {
    display:flex; gap:12px; align-items:center; margin-bottom:18px;
  }
  .logo {
    width:44px; height:44px; border-radius:10px;
    background:linear-gradient(135deg,#0ee6b8,#20b2ff);
    display:flex;align-items:center;justify-content:center;
    font-weight:700;color:#042226; font-size:18px;
    box-shadow: 0 6px 18px rgba(16,163,127,0.12), inset 0 -6px 18px rgba(255,255,255,0.04);
  }
  .brand h2 { margin:0; font-size:18px; font-weight:600; color:var(--text); }
  .brand p { margin:0; font-size:13px; color:var(--muted); }

  h1 { font-size:20px; margin:6px 0 16px; font-weight:600; color:var(--text); text-align:left; }

  form { display:grid; gap:12px; }

  label { font-size:13px; color:var(--muted); margin-bottom:6px; display:block; }

  .field {
    display:flex; flex-direction:column;
  }

  input[type="text"],
  input[type="email"],
  input[type="password"]{
    appearance:none;
    background: linear-gradient(180deg,var(--glass),var(--glass-2));
    border:1px solid rgba(255,255,255,0.04);
    padding:12px 14px;
    border-radius:10px;
    color:var(--text);
    font-size:15px;
    outline:none;
    transition:box-shadow .16s, border-color .16s, transform .12s;
  }
  input::placeholder{ color:rgba(230,238,243,0.35) }
  input:focus{
    box-shadow: 0 6px 20px rgba(16,163,127,0.12), inset 0 1px 0 rgba(255,255,255,0.02);
    border-color: rgba(16,163,127,0.9);
    transform:translateY(-1px);
  }

  .row { display:flex; gap:12px; }
  .col { flex:1; }

  .checkbox {
    display:flex; gap:10px; align-items:center; color:var(--muted); font-size:14px;
  }
  .checkbox input{ width:18px; height:18px; accent-color:var(--accent); border-radius:4px; cursor:pointer;}

  .pw-row{display:flex; gap:8px; align-items:center;}
  .pw-toggle{ background:transparent; border:none; color:var(--muted); cursor:pointer; font-weight:600; font-size:13px; padding:8px; border-radius:8px; }
  .pw-toggle:hover{ color:var(--text) }

  /* password strength bar */
  .strength {
    height:8px; border-radius:6px; background: linear-gradient(90deg,#111 0%, rgba(255,255,255,0.02) 100%); overflow:hidden;
  }
  .strength > i{ display:block; height:100%; width:0%; background:linear-gradient(90deg,#ff6b6b,#ffd36b,#56ffb6); transition:width .35s ease; }

  .btn-primary{
    width:100%; background: linear-gradient(90deg,var(--accent), #00c2a8); border:none; color:#02241f;
    padding:12px; border-radius:10px; font-weight:700; font-size:15px; cursor:pointer;
    box-shadow: 0 6px 18px rgba(16,163,127,0.12); transition:transform .14s, box-shadow .14s;
  }
  .btn-primary:hover{ transform:translateY(-3px); box-shadow:0 18px 40px rgba(16,163,127,0.14) }

  .divider {
    display:flex; align-items:center; gap:12px; color:var(--muted); font-size:13px; margin:10px 0;
  }
  .divider:before, .divider:after{
    content:""; flex:1; height:1px; background: linear-gradient(90deg, transparent, rgba(255,255,255,0.03), transparent);
  }

  /* Google button gets styled container but use GSI render */
  #g_id_signup { width:100%; display:flex; justify-content:center; }

  .footer { text-align:center; margin-top:12px; color:var(--muted); font-size:13px; }
  .footer a{ color:var(--text); text-decoration:none; font-weight:600; opacity:0.9; }
  .footer a:hover{ text-decoration:underline }

  /* small text under title */
  .hint{ color:var(--muted); font-size:13px; margin-top:-4px; margin-bottom:8px }

  /* responsive */
  @media (max-width:480px){
    .card{ padding:18px; border-radius:14px }
    .brand h2{ font-size:16px }
    h1{ font-size:18px }
  }
</style>
</head>
<body>

<!-- decorative blobs -->
<div class="bg-blob blob-a"></div>
<div class="bg-blob blob-b"></div>

<main class="card" role="main" aria-labelledby="signup-title">
  <header class="brand" aria-hidden="false">
    <div class="logo">mA</div>
    <div>
      <h2>mmdrza.AI</h2>
      <p style="margin-top:4px;color:var(--muted);font-size:13px">Create an account to access the assistant</p>
    </div>
  </header>

  <h1 id="signup-title">Create your account</h1>
  <div class="hint">Fast sign up — use email or continue with Google</div>

  <form id="signupForm" autocomplete="on" novalidate>
    <div class="field">
      <label for="name">Full name</label>
      <input id="name" name="name" type="text" placeholder="e.g. Mohammad Reza" required autocomplete="name" />
    </div>

    <div class="field">
      <label for="email">Email address</label>
      <input id="email" name="email" type="email" placeholder="name@example.com" required autocomplete="email" />
    </div>

    <div class="field">
      <label for="password">Password</label>
      <div class="pw-row">
        <input id="password" name="password" type="password" placeholder="Create a strong password" required autocomplete="new-password" style="flex:1;" />
        <button type="button" class="pw-toggle" id="pwToggle" aria-pressed="false" title="Show password">Show</button>
      </div>

      <div style="margin-top:8px;display:flex;gap:10px;align-items:center;">
        <div style="flex:1">
          <div class="strength" aria-hidden="true"><i id="strengthBar"></i></div>
        </div>
        <div style="min-width:68px;text-align:right;color:var(--muted);font-size:13px;" id="strengthText">—</div>
      </div>
    </div>

    <div class="row" style="align-items:center;justify-content:space-between;">
      <div class="checkbox">
        <input type="checkbox" id="ageConfirm" name="ageConfirm" required />
        <label for="ageConfirm">I am 18 or older</label>
      </div>
      <div style="font-size:12px;color:var(--muted)">Terms apply</div>
    </div>

    <!-- reCAPTCHA -->
    <div style="margin-top:6px;margin-bottom:6px;">
      <div class="g-recaptcha" data-sitekey="YOUR_RECAPTCHA_SITE_KEY_HERE"></div>
    </div>

    <button class="btn-primary" id="continueBtn" type="submit">Continue</button>
  </form>

  <div style="margin:14px 0" class="divider">or</div>

  <!-- Google button (GSI will render here) -->
  <div id="g_id_signup"></div>

  <div class="footer">Already have an account? <a href="login.html">Log in</a></div>
</main>

<script>
/* ---------- Replace these with your keys ----------
   - CLIENT_ID: Google OAuth Client ID for Web (from cloud console)
   - RECAPTCHA_SITE_KEY: reCAPTCHA v2 site key (add localhost if testing locally)
---------------------------------------------------*/
const CLIENT_ID = "1082403809887-on2cbp8fi9eruoc0ujiftaahhn0kq0ae.apps.googleusercontent.com";
const RECAPTCHA_SITE_KEY = "6LfFffwrAAAAAIf9uQxmkpDFzju0EkmxULQACc80";
/* ------------------------------------------------- */

/* Password toggle + strength */
const pw = document.getElementById('password');
const pwToggle = document.getElementById('pwToggle');
const strengthBar = document.getElementById('strengthBar');
const strengthText = document.getElementById('strengthText');

pwToggle.addEventListener('click', () => {
  const isHidden = pw.type === 'password';
  pw.type = isHidden ? 'text' : 'password';
  pwToggle.textContent = isHidden ? 'Hide' : 'Show';
  pwToggle.setAttribute('aria-pressed', String(isHidden));
});

/* Simple password strength estimator (fast, client-side) */
function assessPassword(p){
  let score = 0;
  if (!p) return {score:0,label:'—'};
  if (p.length >= 8) score += 1;
  if (p.length >= 12) score += 1;
  if (/[A-Z]/.test(p)) score += 1;
  if (/[0-9]/.test(p)) score += 1;
  if (/[^A-Za-z0-9]/.test(p)) score += 1;
  // score 0..5
  let pct = Math.min(100, (score / 5) * 100);
  let label = ['Very weak','Weak','Okay','Good','Strong','Very strong'][score];
  return {score: Math.round(pct), label};
}

pw.addEventListener('input', () => {
  const p = pw.value;
  const r = assessPassword(p);
  strengthBar.style.width = r.score + '%';
  strengthText.textContent = r.label;
  // color gradient by width
  strengthBar.style.background = r.score < 40
    ? 'linear-gradient(90deg,#ff6b6b,#ffb86b)'
    : (r.score < 70 ? 'linear-gradient(90deg,#ffd36b,#56ffb6)' : 'linear-gradient(90deg,#56ffb6,#10a37f)');
});

/* Signup form handling (demo local flow) */
const signupForm = document.getElementById('signupForm');
signupForm.addEventListener('submit', (ev) => {
  ev.preventDefault();

  // Basic checks
  const name = document.getElementById('name').value.trim();
  const email = document.getElementById('email').value.trim();
  const password = pw.value;
  const isAdult = document.getElementById('ageConfirm').checked;
  // reCAPTCHA response field is filled by script, class g-recaptcha-response
  const captchaResponseEl = document.querySelector('.g-recaptcha-response');
  const captcha = captchaResponseEl ? captchaResponseEl.value : '';

  if (!name || !email || !password || !isAdult) {
    alert("⚠️ Please complete all required fields and confirm age.");
    return;
  }
  if (!captcha) {
    alert("⚠️ Please verify you are not a robot.");
    return;
  }

  // Demo: store user locally (replace with secure server signup flow)
  localStorage.setItem('mmdrzaUser', JSON.stringify({ name, email, password, provider: 'local' }));
  // Friendly micro-feedback
  continueBtnVisualFeedback();
  setTimeout(()=> {
    alert(`🎉 Welcome, ${name}!`);
    window.location.href = 'dashboard.html';
  }, 700);
});

function continueBtnVisualFeedback(){
  const btn = document.getElementById('continueBtn');
  btn.disabled = true;
  btn.style.transform = 'translateY(-2px) scale(.998)';
  btn.style.opacity = '0.92';
  setTimeout(()=> { btn.disabled = false; btn.style.transform = ''; btn.style.opacity = ''; }, 1400);
}

/* ---------- Google Identity (GSI) init ----------
   Renders official Google button and receives credential (ID token)
   NOTE: replace CLIENT_ID constant above with your real client id
----------------------------------------------------*/
window.addEventListener('load', () => {
  if (typeof google === 'undefined' || !google.accounts || !CLIENT_ID) {
    // GSI not loaded or CLIENT_ID missing — render a fallback styled button
    renderGoogleFallback();
    return;
  }

  google.accounts.id.initialize({
    client_id: CLIENT_ID,
    callback: handleGoogleCredential
  });

  // render button into container (GSI will produce its own native button)
  google.accounts.id.renderButton(
    document.getElementById('g_id_signup'),
    { theme: 'outline', size: 'large', width: '100%', locale: 'en' }
  );

  // Optionally prompt (commented out to avoid auto-popup)
  // google.accounts.id.prompt();
});

/* Fallback styled button if GSI fails to load or client id missing */
function renderGoogleFallback(){
  const cont = document.getElementById('g_id_signup');
  cont.innerHTML = '';
  const b = document.createElement('button');
  b.type = 'button';
  b.className = 'btn google-fallback';
  b.style.cssText = "display:flex;align-items:center;justify-content:center;gap:10px;padding:10px;border-radius:10px;border:1px solid rgba(255,255,255,0.06);background:#fff;color:#222;font-weight:600;width:100%";
  b.innerHTML = `<img src="https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg" alt="G" style="width:18px;height:18px"/> Continue with Google`;
  b.addEventListener('click', ()=> alert('Google Sign-In not configured. Set CLIENT_ID in the file.'));
  cont.appendChild(b);
}

/* called by Google after successful signin (GSI) */
function handleGoogleCredential(response){
  if (!response || !response.credential) {
    alert('Google sign-in failed.');
    return;
  }
  const data = parseJwt(response.credential);
  // Example of fields: name, email, picture, sub
  localStorage.setItem('mmdrzaUser', JSON.stringify({
    name: data.name || data.email,
    email: data.email,
    picture: data.picture || '',
    provider: 'google'
  }));
  continueBtnVisualFeedback();
  setTimeout(()=> {
    alert(`✅ Signed up as ${data.name || data.email}`);
    window.location.href = 'dashboard.html';
  }, 700);
}

/* Simple JWT decode (no validation) */
function parseJwt(token){
  try{
    const base64Url = token.split('.')[1];
    const base64 = base64Url.replace(/-/g,'+').replace(/_/g,'/');
    const jsonPayload = decodeURIComponent(atob(base64).split('').map(c=> '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2)).join(''));
    return JSON.parse(jsonPayload);
  }catch(e){
    return {};
  }
}

/* Accessibility: allow Enter to toggle Google fallback if GSI present? keep native behavior. */
/* End script */
</script>
</body>
</html>
